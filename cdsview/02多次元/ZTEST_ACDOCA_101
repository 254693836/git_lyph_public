@AbapCatalog.sqlViewName: 'ZTESTACDOCA101'
@AbapCatalog.compiler.compareFilter: true
@AbapCatalog.preserveKey: true
@AccessControl.authorizationCheck: #NOT_REQUIRED
@EndUserText.label: 'ZTEST_ACDOCA_101'
@Metadata.ignorePropagatedAnnotations: true
@Analytics.dataCategory: #CUBE
define view ZTEST_ACDOCA_101
  as select from acdoca
  association [0..1] to I_Ledger                   as _Ledger      on  $projection.Rldnr = _Ledger.Ledger
  association [1]    to I_CompanyCode              as _CompanyCode on  $projection.Rbukrs = _CompanyCode.CompanyCode
  association [0..1] to I_FiscalYearForCompanyCode as _FiscalYear  on  $projection.Gjahr  = _FiscalYear.FiscalYear
                                                                   and $projection.Rbukrs = _FiscalYear.CompanyCode
                                                                   
// 階層                                                                   
  association [1]    to I_ChartOfAccounts            as _ChartOfAccounts            on  $projection.Ktopl = _ChartOfAccounts.ChartOfAccounts
  association [0..1] to I_GLAccountInChartOfAccounts as _GLAccountInChartOfAccounts on  $projection.Ktopl = _GLAccountInChartOfAccounts.ChartOfAccounts
                                                                                    and $projection.Racct = _GLAccountInChartOfAccounts.GLAccount
  association [0..1] to I_GLAccountInChartOfAccounts as _GLAccountHierarchy         on  $projection.Ktopl = _GLAccountHierarchy.ChartOfAccounts
                                                                                    and $projection.Racct = _GLAccountHierarchy.GLAccount
{
  @ObjectModel.foreignKey.association: '_Ledger'
  key rldnr                    as Rldnr,
  @ObjectModel.foreignKey.association: '_CompanyCode'
  key rbukrs                   as Rbukrs,
  @ObjectModel.foreignKey.association: '_FiscalYear'
  key gjahr                    as Gjahr,
  key belnr                    as Belnr,
  key docln                    as Docln,
      ryear                    as Ryear,
      docnr_ld                 as DocnrLd,
      rrcty                    as Rrcty,
      rmvct                    as Rmvct,
      vorgn                    as Vorgn,
      vrgng                    as Vrgng,
      bttype                   as Bttype,
      cbttype                  as Cbttype,
      awtyp                    as Awtyp,
      awsys                    as Awsys,
      aworg                    as Aworg,
      awref                    as Awref,
      awitem                   as Awitem,
      awitgrp                  as Awitgrp,
      subta                    as Subta,
      xreversing               as Xreversing,
      xreversed                as Xreversed,
      xtruerev                 as Xtruerev,
      awtyp_rev                as AwtypRev,
      aworg_rev                as AworgRev,
      awref_rev                as AwrefRev,
      awitem_rev               as AwitemRev,
      subta_rev                as SubtaRev,
      xsettling                as Xsettling,
      xsettled                 as Xsettled,
      prec_awtyp               as PrecAwtyp,
      prec_awsys               as PrecAwsys,
      prec_aworg               as PrecAworg,
      prec_awref               as PrecAwref,
      prec_awitem              as PrecAwitem,
      prec_subta               as PrecSubta,
      prec_awmult              as PrecAwmult,
      prec_bukrs               as PrecBukrs,
      prec_gjahr               as PrecGjahr,
      prec_belnr               as PrecBelnr,
      prec_docln               as PrecDocln,
      xsecondary               as Xsecondary,
      closing_run_id           as ClosingRunId,
      orgl_change              as OrglChange,
      src_awtyp                as SrcAwtyp,
      src_awsys                as SrcAwsys,
      src_aworg                as SrcAworg,
      src_awref                as SrcAwref,
      src_awitem               as SrcAwitem,
      src_awsubit              as SrcAwsubit,
      xcommitment              as Xcommitment,
      obs_reason               as ObsReason,
      rtcur                    as Rtcur,
      rwcur                    as Rwcur,
      rhcur                    as Rhcur,
      rkcur                    as Rkcur,
      rocur                    as Rocur,
      rvcur                    as Rvcur,
      rbcur                    as Rbcur,
      rccur                    as Rccur,
      rdcur                    as Rdcur,
      recur                    as Recur,
      rfcur                    as Rfcur,
      rgcur                    as Rgcur,
      rco_ocur                 as RcoOcur,
      rgm_ocur                 as RgmOcur,
      runit                    as Runit,
      rvunit                   as Rvunit,
      rrunit                   as Rrunit,
      rmsl_type                as RmslType,
      riunit                   as Riunit,
      qunit1                   as Qunit1,
      qunit2                   as Qunit2,
      qunit3                   as Qunit3,
      co_meinh                 as CoMeinh,
      @ObjectModel.foreignKey.association: '_GLAccountHierarchy'
      racct                    as Racct,
      rcntr                    as Rcntr,
      prctr                    as Prctr,
      rfarea                   as Rfarea,
      rbusa                    as Rbusa,
      kokrs                    as Kokrs,
      segment                  as Segment,
      scntr                    as Scntr,
      pprctr                   as Pprctr,
      sfarea                   as Sfarea,
      sbusa                    as Sbusa,
      rassc                    as Rassc,
      psegment                 as Psegment,
      
      @DefaultAggregation: #SUM
      tsl                      as Tsl,
      wsl                      as Wsl,
      wsl2                     as Wsl2,
      wsl3                     as Wsl3,

      @DefaultAggregation: #SUM
      13.14                   as lyztest, // TODO lyz
      @DefaultAggregation: #SUM
      1                   as rwoCount, // TODO lyz
      
      @DefaultAggregation: #SUM
      hsl                      as Hsl, // 出力した

      @DefaultAggregation: #SUM
      ksl                      as Ksl, // 出力した

      @DefaultAggregation: #SUM
      osl                      as Osl, // 出力した

      @DefaultAggregation: #SUM
      vsl                      as Vsl, // 出力した
      
      
      bsl                      as Bsl,
      csl                      as Csl,
      dsl                      as Dsl,
      esl                      as Esl,
      fsl                      as Fsl,
      gsl                      as Gsl,
      kfsl                     as Kfsl,
      kfsl2                    as Kfsl2,
      kfsl3                    as Kfsl3,
      psl                      as Psl,
      psl2                     as Psl2,
      psl3                     as Psl3,
      pfsl                     as Pfsl,
      pfsl2                    as Pfsl2,
      pfsl3                    as Pfsl3,
      co_osl                   as CoOsl,
      gm_osl                   as GmOsl,
      hslalt                   as Hslalt,
      kslalt                   as Kslalt,
      oslalt                   as Oslalt,
      vslalt                   as Vslalt,
      bslalt                   as Bslalt,
      cslalt                   as Cslalt,
      dslalt                   as Dslalt,
      eslalt                   as Eslalt,
      fslalt                   as Fslalt,
      gslalt                   as Gslalt,
      hslext                   as Hslext,
      kslext                   as Kslext,
      oslext                   as Oslext,
      vslext                   as Vslext,
      bslext                   as Bslext,
      cslext                   as Cslext,
      dslext                   as Dslext,
      eslext                   as Eslext,
      fslext                   as Fslext,
      gslext                   as Gslext,
      hvkwrt                   as Hvkwrt,
      msl                      as Msl,
      mfsl                     as Mfsl,
      vmsl                     as Vmsl,
      vmfsl                    as Vmfsl,
      rmsl                     as Rmsl,
      quant1                   as Quant1,
      quant2                   as Quant2,
      quant3                   as Quant3,
      co_megbtr                as CoMegbtr,
      co_mefbtr                as CoMefbtr,
      hsalk3                   as Hsalk3,
      ksalk3                   as Ksalk3,
      osalk3                   as Osalk3,
      vsalk3                   as Vsalk3,
      hsalkv                   as Hsalkv,
      ksalkv                   as Ksalkv,
      osalkv                   as Osalkv,
      vsalkv                   as Vsalkv,
      hpvprs                   as Hpvprs,
      kpvprs                   as Kpvprs,
      opvprs                   as Opvprs,
      vpvprs                   as Vpvprs,
      hstprs                   as Hstprs,
      kstprs                   as Kstprs,
      ostprs                   as Ostprs,
      vstprs                   as Vstprs,
      hvksal                   as Hvksal,
      lbkum                    as Lbkum,
      drcrk                    as Drcrk,
      poper                    as Poper,
      periv                    as Periv,
      fiscyearper              as Fiscyearper,
      budat                    as Budat,
      bldat                    as Bldat,
      blart                    as Blart,
      buzei                    as Buzei,
      zuonr                    as Zuonr,
      bschl                    as Bschl,
      bstat                    as Bstat,
      linetype                 as Linetype,
      ktosl                    as Ktosl,
      slalittype               as Slalittype,
      xsplitmod                as Xsplitmod,
      usnam                    as Usnam,
      timestamp                as Timestamp,
      eprctr                   as Eprctr,
      rhoart                   as Rhoart,
      glaccount_type           as GlaccountType,
      @ObjectModel.foreignKey.association: '_ChartOfAccounts'
      ktopl                    as Ktopl,
      lokkt                    as Lokkt,
      ktop2                    as Ktop2,
      rebzg                    as Rebzg,
      rebzj                    as Rebzj,
      rebzz                    as Rebzz,
      rebzt                    as Rebzt,
      rbest                    as Rbest,
      ebeln_logsys             as EbelnLogsys,
      ebeln                    as Ebeln,
      ebelp                    as Ebelp,
      zekkn                    as Zekkn,
      sgtxt                    as Sgtxt,
      kdauf                    as Kdauf,
      kdpos                    as Kdpos,
      matnr                    as Matnr,
      werks                    as Werks,
      lifnr                    as Lifnr,
      kunnr                    as Kunnr,
      fbuda                    as Fbuda,
      perop_beg                as PeropBeg,
      perop_end                as PeropEnd,
      coco_num                 as CocoNum,
      wwert                    as Wwert,
      prctr_drvtn_source_type  as PrctrDrvtnSourceType,
      koart                    as Koart,
      umskz                    as Umskz,
      tax_country              as TaxCountry,
      mwskz                    as Mwskz,
      hbkid                    as Hbkid,
      hktid                    as Hktid,
      valut                    as Valut,
      xopvw                    as Xopvw,
      augdt                    as Augdt,
      augbl                    as Augbl,
      auggj                    as Auggj,
      afabe                    as Afabe,
      anln1                    as Anln1,
      anln2                    as Anln2,
      bzdat                    as Bzdat,
      anbwa                    as Anbwa,
      movcat                   as Movcat,
      depr_period              as DeprPeriod,
      anlgr                    as Anlgr,
      anlgr2                   as Anlgr2,
      settlement_rule          as SettlementRule,
      anlkl                    as Anlkl,
      ktogr                    as Ktogr,
      panl1                    as Panl1,
      panl2                    as Panl2,
      ubzdt_pn                 as UbzdtPn,
      xvabg_pn                 as XvabgPn,
      prozs_pn                 as ProzsPn,
      xmanpropval_pn           as XmanpropvalPn,
      kalnr                    as Kalnr,
      vprsv                    as Vprsv,
      mlast                    as Mlast,
      kzbws                    as Kzbws,
      xobew                    as Xobew,
      sobkz                    as Sobkz,
      vtstamp                  as Vtstamp,
      mat_kdauf                as MatKdauf,
      mat_kdpos                as MatKdpos,
      mat_pspnr                as MatPspnr,
      mat_ps_posid             as MatPsPosid,
      mat_lifnr                as MatLifnr,
      bwtar                    as Bwtar,
      bwkey                    as Bwkey,
      hpeinh                   as Hpeinh,
      kpeinh                   as Kpeinh,
      opeinh                   as Opeinh,
      vpeinh                   as Vpeinh,
      mlptyp                   as Mlptyp,
      mlcateg                  as Mlcateg,
      qsbvalt                  as Qsbvalt,
      qsprocess                as Qsprocess,
      perart                   as Perart,
      mlposnr                  as Mlposnr,
      inv_mov_categ            as InvMovCateg,
      bukrs_sender             as BukrsSender,
      racct_sender             as RacctSender,
      accas_sender             as AccasSender,
      accasty_sender           as AccastySender,
      objnr                    as Objnr,
      hrkft                    as Hrkft,
      hkgrp                    as Hkgrp,
      parob1                   as Parob1,
      parobsrc                 as Parobsrc,
      uspob                    as Uspob,
      co_belkz                 as CoBelkz,
      co_beknz                 as CoBeknz,
      beltp                    as Beltp,
      muvflg                   as Muvflg,
      gkont                    as Gkont,
      gkoar                    as Gkoar,
      erlkz                    as Erlkz,
      pernr                    as Pernr,
      paobjnr                  as Paobjnr,
      xpaobjnr_co_rel          as XpaobjnrCoRel,
      scope                    as Scope,
      logsyso                  as Logsyso,
      pbukrs                   as Pbukrs,
      pscope                   as Pscope,
      logsysp                  as Logsysp,
      bwstrat                  as Bwstrat,
      objnr_hk                 as ObjnrHk,
      aufnr_org                as AufnrOrg,
      ukostl                   as Ukostl,
      ulstar                   as Ulstar,
      uprznr                   as Uprznr,
      uprctr                   as Uprctr,
      umatnr                   as Umatnr,
      varc_uacct               as VarcUacct,
      accas                    as Accas,
      accasty                  as Accasty,
      lstar                    as Lstar,
      aufnr                    as Aufnr,
      autyp                    as Autyp,
      ps_psp_pnr               as PsPspPnr,
      ps_posid                 as PsPosid,
      ps_prj_pnr               as PsPrjPnr,
      ps_pspid                 as PsPspid,
      nplnr                    as Nplnr,
      nplnr_vorgn              as NplnrVorgn,
      prznr                    as Prznr,
      kstrg                    as Kstrg,
      bemot                    as Bemot,
      rsrce                    as Rsrce,
      qmnum                    as Qmnum,
      service_doc_type         as ServiceDocType,
      service_doc_id           as ServiceDocId,
      service_doc_item_id      as ServiceDocItemId,
      service_contract_type    as ServiceContractType,
      service_contract_id      as ServiceContractId,
      service_contract_item_id as ServiceContractItemId,
      solution_order_id        as SolutionOrderId,
      solution_order_item_id   as SolutionOrderItemId,
      erkrs                    as Erkrs,
      paccas                   as Paccas,
      paccasty                 as Paccasty,
      plstar                   as Plstar,
      paufnr                   as Paufnr,
      pautyp                   as Pautyp,
      pps_psp_pnr              as PpsPspPnr,
      pps_posid                as PpsPosid,
      pps_prj_pnr              as PpsPrjPnr,
      pps_pspid                as PpsPspid,
      pkdauf                   as Pkdauf,
      pkdpos                   as Pkdpos,
      ppaobjnr                 as Ppaobjnr,
      pnplnr                   as Pnplnr,
      pnplnr_vorgn             as PnplnrVorgn,
      pprznr                   as Pprznr,
      pkstrg                   as Pkstrg,
      pservice_doc_type        as PserviceDocType,
      pservice_doc_id          as PserviceDocId,
      pservice_doc_item_id     as PserviceDocItemId,
      co_accasty_n1            as CoAccastyN1,
      co_accasty_n2            as CoAccastyN2,
      co_accasty_n3            as CoAccastyN3,
      co_zlenr                 as CoZlenr,
      co_belnr                 as CoBelnr,
      co_buzei                 as CoBuzei,
      co_buzei1                as CoBuzei1,
      co_buzei2                as CoBuzei2,
      co_buzei5                as CoBuzei5,
      co_buzei6                as CoBuzei6,
      co_buzei7                as CoBuzei7,
      co_refbz                 as CoRefbz,
      co_refbz1                as CoRefbz1,
      co_refbz2                as CoRefbz2,
      co_refbz5                as CoRefbz5,
      co_refbz6                as CoRefbz6,
      co_refbz7                as CoRefbz7,
      overtimecat              as Overtimecat,
      work_item_id             as WorkItemId,
      arbid                    as Arbid,
      vornr                    as Vornr,
      aufps                    as Aufps,
      uvorn                    as Uvorn,
      equnr                    as Equnr,
      tplnr                    as Tplnr,
      istru                    as Istru,
      ilart                    as Ilart,
      plknz                    as Plknz,
      artpr                    as Artpr,
      priok                    as Priok,
      maufnr                   as Maufnr,
      matkl_mm                 as MatklMm,
      paufps                   as Paufps,
      planned_parts_work       as PlannedPartsWork,
      fkart                    as Fkart,
      vkorg                    as Vkorg,
      vtweg                    as Vtweg,
      spart                    as Spart,
      matnr_copa               as MatnrCopa,
      matkl                    as Matkl,
      kdgrp                    as Kdgrp,
      land1                    as Land1,
      brsch                    as Brsch,
      bzirk                    as Bzirk,
      kunre                    as Kunre,
      kunwe                    as Kunwe,
      konzs                    as Konzs,
      acdoc_copa_eew_dummy_pa  as AcdocCopaEewDummyPa,
      kmatyp_pa                as KmatypPa,
      kmbrnd_pa                as KmbrndPa,
      kmcatg_pa                as KmcatgPa,
      kmdest_pa                as KmdestPa,
      kmfltn_pa                as KmfltnPa,
      kmflty_pa                as KmfltyPa,
      kmhi01_pa                as Kmhi01Pa,
      kmhi02_pa                as Kmhi02Pa,
      kmhi03_pa                as Kmhi03Pa,
      kmiata_pa                as KmiataPa,
      kmkdgr_pa                as KmkdgrPa,
      kmland_pa                as KmlandPa,
      vkgrp_pa                 as VkgrpPa,
      colle_pa                 as CollePa,
      prodh_pa                 as ProdhPa,
      saisj_pa                 as SaisjPa,
      saiso_pa                 as SaisoPa,
      sorhist_pa               as SorhistPa,
      theme_pa                 as ThemePa,
      vkbur_pa                 as VkburPa,
      partner_pa               as PartnerPa,
      maabc_pa                 as MaabcPa,
      kmzone_pa                as KmzonePa,
      kmlegs_pa                as KmlegsPa,
      kmmakl_pa                as KmmaklPa,
      kmopdy_pa                as KmopdyPa,
      kmorig_pa                as KmorigPa,
      ww001_pa                 as Ww001Pa,
      ww002_pa                 as Ww002Pa,
      ww003_pa                 as Ww003Pa,
      kmvkbu_pa                as KmvkbuPa,
      kmvkgr_pa                as KmvkgrPa,
      kmvtnr_pa                as KmvtnrPa,
      kmwnhg_pa                as KmwnhgPa,
      artnrg_pa                as ArtnrgPa,
      ww010_pa                 as Ww010Pa,
      ww058_pa                 as Ww058Pa,
      gebie_pa                 as GebiePa,
      ww004_pa                 as Ww004Pa,
      wwf01_pa                 as Wwf01Pa,
      bonus_pa                 as BonusPa,
      crmcsty_pa               as CrmcstyPa,
      crmelem_pa               as CrmelemPa,
      crmfigr_pa               as CrmfigrPa,
      eform_pa                 as EformPa,
      kmniel_pa                as KmnielPa,
      kmrout_pa                as KmroutPa,
      kmstge_pa                as KmstgePa,
      ww006_pa                 as Ww006Pa,
      ww100_pa                 as Ww100Pa,
      ww688_pa                 as Ww688Pa,
      ww600_pa                 as Ww600Pa,
      ww987_pa                 as Ww987Pa,
      ww005_pa                 as Ww005Pa,
      ww901_pa                 as Ww901Pa,
      ww902_pa                 as Ww902Pa,
      wwg00_pa                 as Wwg00Pa,
      kunnr_pa                 as KunnrPa,
      abrvw_pa                 as AbrvwPa,
      auart_pa                 as AuartPa,
      ekgrp_pa                 as EkgrpPa,
      extwg_pa                 as ExtwgPa,
      ktokd_pa                 as KtokdPa,
      kukla_pa                 as KuklaPa,
      ww601_pa                 as Ww601Pa,
      matnr_pa                 as MatnrPa,
      katr2_pa                 as Katr2Pa,
      ww900_pa                 as Ww900Pa,
      ww910_pa                 as Ww910Pa,
      ww920_pa                 as Ww920Pa,
      wwx01_pa                 as Wwx01Pa,
      wwx03_pa                 as Wwx03Pa,
      regio_pa                 as RegioPa,
      wwcit_pa                 as WwcitPa,
      wwcar_pa                 as WwcarPa,
      dummy_mrkt_sgmnt_eew_ps  as DummyMrktSgmntEewPs,
      re_bukrs                 as ReBukrs,
      re_account               as ReAccount,
      fikrs                    as Fikrs,
      fipex                    as Fipex,
      fistl                    as Fistl,
      measure                  as Measure,
      rfund                    as Rfund,
      rgrant_nbr               as RgrantNbr,
      rbudget_pd               as RbudgetPd,
      sfund                    as Sfund,
      sgrant_nbr               as SgrantNbr,
      sbudget_pd               as SbudgetPd,
      bdgt_account             as BdgtAccount,
      bdgt_account_cocode      as BdgtAccountCocode,
      bdgt_cnsmpn_date         as BdgtCnsmpnDate,
      bdgt_cnsmpn_period       as BdgtCnsmpnPeriod,
      bdgt_cnsmpn_year         as BdgtCnsmpnYear,
      bdgt_relevant            as BdgtRelevant,
      bdgt_cnsmpn_type         as BdgtCnsmpnType,
      bdgt_cnsmpn_amount_type  as BdgtCnsmpnAmountType,
      rsponsored_prog          as RsponsoredProg,
      rsponsored_class         as RsponsoredClass,
      rbdgt_vldty_nbr          as RbdgtVldtyNbr,
      kblnr                    as Kblnr,
      kblpos                   as Kblpos,
      vname                    as Vname,
      egrup                    as Egrup,
      recid                    as Recid,
      vptnr                    as Vptnr,
      btype                    as Btype,
      etype                    as Etype,
      prodper                  as Prodper,
      billm                    as Billm,
      pom                      as Pom,
      cbrunid                  as Cbrunid,
      jvactivity               as Jvactivity,
      pvname                   as Pvname,
      pegrup                   as Pegrup,
      s_recind                 as SRecind,
      cbracct                  as Cbracct,
      cbobjnr                  as Cbobjnr,
      swenr                    as Swenr,
      sgenr                    as Sgenr,
      sgrnr                    as Sgrnr,
      smenr                    as Smenr,
      recnnr                   as Recnnr,
      snksl                    as Snksl,
      sempsl                   as Sempsl,
      dabrz                    as Dabrz,
      pswenr                   as Pswenr,
      psgenr                   as Psgenr,
      psgrnr                   as Psgrnr,
      psmenr                   as Psmenr,
      precnnr                  as Precnnr,
      psnksl                   as Psnksl,
      psempsl                  as Psempsl,
      pdabrz                   as Pdabrz,
      acrobjtype               as Acrobjtype,
      acrlogsys                as Acrlogsys,
      acrobj_id                as AcrobjId,
      acrsobj_id               as AcrsobjId,
      acritmtype               as Acritmtype,
      acrvaldat                as Acrvaldat,
      valobjtype               as Valobjtype,
      valobj_id                as ValobjId,
      valsobj_id               as ValsobjId,
      netdt                    as Netdt,
      risk_class               as RiskClass,
      acdoc_eew_dummy          as AcdocEewDummy,
      dummy_incl_eew_cobl      as DummyInclEewCobl,
      zzps01                   as Zzps01,
      zzps02                   as Zzps02,
      fup_action               as FupAction,
      sdm_version              as SdmVersion,
      mig_source               as MigSource,
      mig_docln                as MigDocln,
      _dataaging               as Dataaging,
      _Ledger,
      _CompanyCode,
      _FiscalYear,
      _ChartOfAccounts,
      _GLAccountHierarchy,
      _GLAccountInChartOfAccounts,
      
      ''                       as endtest
}
where hsl > 0 
